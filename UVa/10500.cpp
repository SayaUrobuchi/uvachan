#include<stdio.h>
#include<string.h>
int a,b,c,d,e,f,g,h,i,j,k[10][10];
char l[42][42],m;
int abcc(int p,int q)
{
	char y;
	y=1;
	e++;
	if(p>0)
	{
		if(!k[p-1][q])
		{
			k[p-1][q]=2;
			if(y)
			{
				y=0;
				i-=2;
				abcc(p-1,q);
				i+=2;
			}
			l[i-2][j]=48;
		}
		else if(k[p-1][q]==1)
		{
			l[i-2][j]='X';
		}
	}
	if(q<b-1)
	{
		if(!k[p][q+1])
		{
			k[p][q+1]=2;
			if(y)
			{
				y=0;
				j+=4;
				abcc(p,q+1);
				j-=4;
			}
			l[i][j+4]=48;
		}
		else if(k[p][q+1]==1)
		{
			l[i][j+4]='X';
		}
	}
	if(p<a-1)
	{
		if(!k[p+1][q])
		{
			k[p+1][q]=2;
			if(y)
			{
				y=0;
				i+=2;
				abcc(p+1,q);
				i-=2;
			}
			l[i+2][j]=48;
		}
		else if(k[p+1][q]==1)
		{
			l[i+2][j]='X';
		}
	}
	if(q>0)
	{
		if(!k[p][q-1])
		{
			k[p][q-1]=2;
			if(y)
			{
				y=0;
				j-=4;
				abcc(p,q-1);
				j+=4;
			}
			l[i][j-4]=48;
		}
		else if(k[p][q-1]==1)
		{
			l[i][j-4]='X';
		}
	}
	return 0;
}
int main()
{
	for(a=0;a<42;a+=2)
	{
		l[a][0]='|';
	}
	for(a=1;a<42;a++)
	{
		for(b=0;b<3;a++,b++)
		{
			for(c=0;c<42;c+=2)
			{
				l[c][a]='-';
			}
		}
		for(c=0;c<42;c+=2)
		{
			l[c][a]='|';
		}
	}
	l[1][0]='|';
	for(a=1;a<41;)
	{
		for(b=0;b<3;a++,b++)
		{
			l[1][a]=32;
		}
		l[1][a++]='|';
	}
	l[1][41]=0;
	for(a=3;a<42;a+=2)
	{
		strcpy(l[a],l[1]);
	}
	while(scanf("%d%d",&a,&b)==2)
	{
		if(!a&&!b)
		{
			break;
		}
		printf("\n");
		scanf("%d%d",&c,&d);
		for(e=0,i=1;e<a;e++,i+=2)
		{
			for(f=0,j=2;f<b;f++,j+=4)
			{
				l[i][j]='?';
			}
		}
		for(e=0;e<a;e++)
		{
			for(f=0;f<b;f++)
			{
				scanf("%s",&m);
				if(m==48)
				{
					k[e][f]=0;
				}
				else
				{
					k[e][f]=1;
				}
			}
		}
		c--;
		d--;
		i=1+c*2;
		j=2+d*4;
		k[c][d]=2;
		l[i][j]=48;
		e=0;
		abcc(c,d);
		i=b*4+1;
		j=a*2+1;
		for(c=0;c<j;c++)
		{
			m=l[c][i];
			l[c][i]=0;
			printf("%s\n",l[c]);
			l[c][i]=m;
		}
		printf("\nNUMBER OF MOVEMENTS: %d\n",e-1);
	}
	return 0;
}
