#include<stdio.h>
#include<string.h>
#include<math.h>
int main()
{
	char x,y[201];
	int a,b,c,d,e,f,g,h;
	double i,j,k;
	h=0;
	k=sqrt(2);
	g=0;
	while(scanf("%c",&x)==1)
	{
		if(x=='E')
		{
			scanf("%c",&x);
			scanf("%c",&x);
			scanf("%c",&x);
			break;
		}
		h++;
		/*if(g==1)
		{
			printf("\n");
		}
		g=1;*/
		printf("Map #%d\n",h);
		a=x-48;
		b=0;
		i=0;
		j=0;
		while(scanf("%c",&x)==1)
		{
			if(x>47&&x<58)
			{
				a*=10;
				a+=x-48;
			}
			else if(x=='N')
			{
				if(b==0)
				{
					b=1;
				}
				else
				{
					b*=10;
					b++;
				}
			}
			else if(x=='S')
			{
				if(b==0)
				{
					b=2;
				}
				else
				{
					b*=10;
					b+=2;
				}
			}
			else if(x=='E')
			{
				if(b==0)
				{
					b=3;
				}
				else
				{
					b*=10;
					b+=3;
				}
			}
			else if(x=='W')
			{
				if(b==0)
				{
					b=4;
				}
				else
				{
					b*=10;
					b+=4;
				}
			}
			else if(x==','||x=='.')
			{
				if(b>10)
				{
					c=b%10;
					d=c%2;
					c--;
					c/=2;
					if(d==1)
					{
						if(c==0)
						{
							i+=a/k;
						}
						else
						{
							j+=a/k;
						}
					}
					else
					{
						if(c==0)
						{
							i-=a/k;
						}
						else
						{
							j-=a/k;
						}
					}
					c=b/10;
					d=c%2;
					c--;
					c/=2;
					if(d==1)
					{
						if(c==0)
						{
							i+=a/k;
						}
						else
						{
							j+=a/k;
						}
					}
					else
					{
						if(c==0)
						{
							i-=a/k;
						}
						else
						{
							j-=a/k;
						}
					}
				}
				else
				{
					c=b;
					d=c%2;
					c--;
					c/=2;
					if(d==1)
					{
						if(c==0)
						{
							i+=a;
						}
						else
						{
							j+=a;
						}
					}
					else
					{
						if(c==0)
						{
							i-=a;
						}
						else
						{
							j-=a;
						}
					}
				}
				//printf("%.3f\n",i);
				if(x=='.')
				{
					scanf("%c",&x);
					break;
				}
				a=0;
				b=0;
			}
		}
		printf("The treasure is located at (%.3f,%.3f).\n",j+(10e-12),i+(10e-12));
		i*=i;
		i+=j*j;
		i=sqrt(i);
		printf("The distance to the treasure is %.3f.\n\n",i+(10e-12));
	}
	return 0;
}